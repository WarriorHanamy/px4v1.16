#!/bin/bash

# é»˜è®¤è®¾ç½®ï¼šé»˜è®¤ä¸º Headless æ¨¡å¼ (1)
IS_HEADLESS=1
MODEL="gz_x500"

# æ£€æŸ¥å‚æ•°
if [ -n "$1" ]; then
    IS_HEADLESS=0 # æœ‰å‚æ•°åˆ™éœ€è¦ GUI (å…³é—­ Headless)
    case "$1" in
        2)
            MODEL="gz_quadtailsitter"
            ;;
        *)
            MODEL="gz_x500" 
            ;;
    esac
fi

# --- æ‰§è¡Œ ---
echo "ğŸš€ Starting MicroXRCEAgent on port 8888..."
MicroXRCEAgent udp4 -p 8888 & 

if [ "$IS_HEADLESS" -eq 1 ]; then
    echo "ğŸš Starting PX4 SITL ($MODEL) -- Mode: Headless"
    HEADLESS=1 make px4_sitl $MODEL
else
    echo "ğŸš Starting PX4 SITL ($MODEL) -- Mode: GUI"
    make px4_sitl $MODEL
fi
